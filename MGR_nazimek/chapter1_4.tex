 \section{Istniej¹ce podejœcia do integracji}
Istnieje kilka powszechnie znanych sposobów integracji, które maj¹ swoje mocne i
s³abe strony. Mo¿na zauwa¿yæ, ¿e pojawia³y siê one wraz z rozwojem systemów
informatycznych i ka¿dy z nich odpowiada jakiemuœ etapowi rozwoju (np.
istnienie plików jako podstawowych struktur przechowuj¹cych dane na d³ugo przed
pojawieniem siê baz danych). Mimo to, ka¿dy z nich ci¹gle znajduje swoje
zastosowanie, gdy okazuje siê, ¿e nie wszystkie mechanizmy s¹ jednakowo
dostêpne lub, gdy bardziej skomplikowane technologie wprowadzaj¹ zbyt du¿y
narzut. Autorzy \cite{Entpatterns} wyró¿niaj¹ nastêpuj¹ce podejœcia do
integracji:

\index{pliki}
\paragraph{Transfer plików}- jedna aplikacja zapisuje plik w okreœlonym
formacie w ustalonym miejscu, nastêpnie druga go odczytuje i przetwarza. Zalet¹
takiego rozwi¹zania jest jego dostêpnoœæ - prawie zawsze bêdziemy mieli
dostêp do systemu plików. Poza tym nie musimy wiedzieæ, jak dzia³a
aplikacja. Jedyne, co powinniœmy zrobiæ, to dostarczyæ plik we w³aœciwym
formacie. Z drugiej strony, nie istnieje ¿aden sposób wymuszenia formatu
zapisywanego pliku. Mo¿emy zapisaæ na dysku dowolny plik, a aplikacja
docelowa bêdzie go mog³a ewentualnie odrzuciæ.
  
\index{baza danych}  
\paragraph{Wspólna baza danych}- dwie aplikacje dzia³aj¹ na jednej bazie
danych. W momencie, gdy obie korzystaj¹ z tych samych danych, to nie ma potrzeby
ich duplikacji. Dodatkowo, przez ograniczenia wymuszone przez bazê musimy
je zapisywaæ w œciœle okreœlonym formacie, przestrzegaj¹c typów i wiêzów
integralnoœci. Niestety, trudno jest tak¹ bazê zaprojektowaæ. Gdybyœmy
nawet stworzyli dwie aplikacje wspó³pracuj¹ce z jedn¹ baz¹ danych,
to w wypadku, gdybyœmy chcieli do³¹czyæ kolejn¹ wspó³pracuj¹c¹ aplikacjê,
mog³oby siê to wi¹zaæ z koniecznoœci¹ przemodelowania bazy danych. Dodatkowo,
zmiana danych w bazie nie zawsze wystarczy. Mo¿emy sobie wyobraziæ sytuacjê,
w której zmiana wysokoœci pensji niesie za sob¹ koniecznoœæ wykonania
dodatkowych czynnoœci, np. zmiany wysokoœci sk³adki w systemie
ubezpieczeniowym.
\index{RPC}
\paragraph{Zdalne wywo³ywanie procedur}- mo¿e siê odbywaæ z
wykorzystaniem mechanizmów typowych dla danej technologii (RPC,RMI czy
WebServices). Jedna aplikacja udostêpnia funkcjonalnoœæ, która mo¿e zostaæ
wywo³ana z poziomu drugiej. Komunikacja odbywa siê synchronicznie. 
Aplikacja wywo³uj¹ca oczekuje na wynik przetwarzania. Zalet¹ takiego
rozwi¹zania jest dobra hermetyzacja wywo³ania - nie istnieje mo¿liwoœæ
wywo³ania nieistniej¹cej funkcjonalnoœci z przekazaniem parametrów nie
spe³niaj¹cych okreœlonych za³o¿eñ. Wywo³anie zdalnej procedury po odpowiednim
skonfigurowaniu ca³ego systemu nie powinno siê ró¿niæ od wywo³ania procedury w
obrêbie tej samej aplikacji. Pomimo wygody takiego rozwi¹zania, stwarza ono
pewne niebezpieczeñstwo. Programista nieœwiadomy narzutu stwarzanego przez
zdalne wywo³anie procedur mo¿e wywo³ywaæ je z równ¹ beztrosk¹ niczym
procedury lokalne. Grozi to powolnym dzia³aniem systemu, je¿eli wywo³ania bêd¹
siê odbywa³y za poœrednictwem wolnego kana³u komunikacyjnego.
\index{wiadomoœci}
\paragraph{Wiadomoœci}- jedna aplikacja wysy³a komunikat do wspólnego kana³u
komunikacyjnego. Druga aplikacjê odbiera wiadomoœæ z kana³u, a nastêpnie j¹
przetwarza. Komunikacja odbywa siê asynchronicznie. Po umieszczeniu komunikatu w
kanale aplikacja kontynuuje dzia³anie. Odbiorca komunikatu mo¿e go odebraæ w dogodnym
dla siebie momencie. Rozwi¹zanie to nie wprowadza œcis³ych zale¿noœci
pomiêdzy systemami, podobnie jak przesy³anie plików. Pewn¹ niedogodnoœci¹
takiego rozwi¹zania jest jednak wiêksze skomplikowanie systemu, wynikaj¹ce z
wprowadzenia dodatkowego elementu - brokera wiadomoœci.

\subsection{Wybór technologii do integracji mobilnej}

Do osi¹gniêcia celu pracy konieczne jest dokonanie wyboru metody
komunikacji urz¹dzenia mobilnego z klasycznym systemem informatycznym. W tym
celu nale¿y rozwa¿yæ nastêpuj¹ce zagadnienia:

\begin{itemize}
  \item Jakie mechanizmy s¹ dostêpne w obu œrodowiskach?
  \item Jakie s¹ oczekiwania u¿ytkowników co do zintegrowanych systemów i jak
  wybór metody integracji wp³ywa na ich spe³nienie?
\end{itemize} 

Rozwa¿aj¹c te kwestie, mo¿emy stwierdziæ, ¿e u¿ytkownik, szczególnie gdy jest
przyzwyczajony do pracy w klasycznym œrodowisku informatycznym, oczekuje, ¿e
komunikacja bêdzie siê odbywa³a jak najszybciej, bez uci¹¿liwych okresów
oczekiwania. Dodatkowo, oczywistymi wymaganiami s¹ bezpieczeñstwo i niezawodnoœæ komunikacji.
Z drugiej strony musimy pamiêtaæ, ¿e warunki, w jakich mo¿emy komunikowaæ siê z
urz¹dzeniem przenoœnym, s¹ dalekie od doskona³ych.
To sprawia, ¿e komunikacjê nale¿y tak zaprojektowaæ, aby przerwy by³y jak
najmniej odczuwalne. 
Systemy komunikacyjne, takie jak RPC, RMI czy CORBA projektowane by³y dla
warunków, w których problemy komunikacyjne s¹ sytuacj¹ nadzwyczajn¹. Tymczasem,
w przypadku ³¹cznoœci bezprzewodowej, utrata po³¹czenia jest czymœ, czego mo¿emy
siê spodziewaæ.\\
\indent
Zacznijmy od ograniczenia wyboru do technologii, z których mo¿emy skorzystaæ w
œrodowisku mobilnym. Na samym pocz¹tku musimy wyeliminowaæ transfer plików
jako metodê wymagaj¹c¹ spe³nienia jednego z warunków: dostêp do wspólnego
systemu plików lub obs³uga prostego protoko³u przesy³ania plików (np. FTP).
Pierwsza mo¿liwoœæ jest trudna do zagwarantowania ze wzglêdu na brak
wsparcia powszechnie stosowanych systemów plików we wszystkich urz¹dzeniach
mobilnych (chocia¿ s¹ wyj¹tki, np. FAT), a tak¿e mo¿liwe przerwy w komunikacji,
o których wspominaliœmy wczeœniej. Drugie rozwi¹zanie - obs³uga uniwersalnego
protoko³u przesy³ania plików - nie jest powszechnie wspierana. Poza tym, tak¿e
tu pojawia siê problem zawodnej komunikacji. \\
\indent
Wspólna baza danych równie¿ jest rozwi¹zaniem, którego nie mo¿emy wzi¹æ
pod uwagê. G³ówn¹ przeszkod¹ jest brak uniwersalnego sposobu pod³¹czenia do
bazy dzia³aj¹cej w klasycznym systemie. Du¿e ograniczenia platformy mobilnej nie
pozwalaj¹ na uruchomienie sterowników do baz danych przeznaczonych dla
klasycznych systemów. Dodatkowo, ich rozmiar nierzadko przekracza rozmiar
mobilnych aplikacji. Jednak¿e, nawet gdyby uda³o siê stworzyæ sterowniki
pozwalaj¹ce na dostêp do bazy danych z poziomu urz¹dzenia mobilnego, ponownie
spotkalibyœmy siê z problemem zawodnej komunikacji.\\ Okazuje siê, ¿e dwie godne rozwa¿enia metody stanowi¹, z jednej strony,
wiadomoœci, a z drugiej - Web serwisy (s¹ one jednym ze sposobów zdalnego
wywo³ywania procedur).

\index{webserwisy}
\paragraph{Zdalne wywo³ywanie procedur - Web serwisy}
Pomimo, i¿ istnieje kilka ró¿nych standardów RPC, Web
serwisy s¹ jedynym praktycznie stosowanym w przypadku integracji mobilnej.
Jest to bezpoœrednio zwi¹zane z du¿¹ niezale¿noœci¹ od platformy, jak¹
gwarantuje zastosowanie protoko³u SOAP oraz popularnoœci¹ i powszechn¹
akceptacj¹ jako standardu komunikacji odrêbnych systemów. Ich wyj¹tkowa si³a
le¿y w zastosowaniu kilku powszechnych technologii internetowych, takich jak
protokó³ HTTP czy jêzyk XML. Daje to nam gwarancjê, ¿e nie ma znaczenia, w
jakiej technologii i w jakim systemie pracuje dana aplikacja komunikuj¹ca siê
za pomoc¹ Web Services. Trzy fundamentalne elementy wchodz¹ce w sk³ad tej
technologii mo¿na zobaczyæ na rysunku \ref{fig:safaribrowser}.

\begin{figure}[htb]
    \begin{center}
    \includegraphics[angle=0,scale=0.4]{img/Webservices.png}
    \end{center}
    \caption{Trzy podstawowe elementy zwi¹zane z Web Services}
    \label{fig:safaribrowser}
\end{figure}

Wspomniany wczeœniej SOAP, czyli Simple Object Access Protocol jest form¹
elektronicznej koperty, która zawiera podstawowe informacje o ¿¹daniu oraz o
odpowiedzi. Jest ona zbudowana w oparciu o jêzyk XML. Drug¹ kluczow¹ technologi¹
jest jêzyk opisu us³ugi - Web Service Description Language (WSDL). Z jego
pomoc¹ jesteœmy w stanie poinformowaæ, jakie us³ugi oferuje nasz serwer oraz
mo¿emy wskazaæ dok³adny sposób ich wywo³ywania. W wypadku urz¹dzeñ o
ograniczonej mocy obliczeniowej spotyka siê go tylko przy automatycznym
generowaniu kodu wywo³uj¹cego Web Services. Ostatnim fundamentem tej
technologii jest us³uga UDDI (Universal Description, Discovery, and
Integration). Pozwala ona na dynamiczne odnajdowanie innych us³ug Web. 
\newline
Najwiêksz¹ wad¹ tego rozwi¹zania jest pewien narzut wydajnoœciowy oraz
pojemnoœciowy, zwi¹zany z budow¹ samych wiadomoœci. W innych metodach treœæ
wiadomoœci przesy³ana jest w zoptymalizowanej postaci kodu binarnego i nie
posiada zwykle ¿adnych metadanych (co zwykle prowadzi do problemów z komunikacj¹
pomiêdzy ró¿nymi platformami). W przypadku Web Services wiadomoœci przesy³ane
s¹ w kopercie zbudowanej na bazie XML, która zawiera du¿o nadmiernych
informacji. Powoduje to, ¿e przy przesy³aniu wiadomoœci ³¹cze dodatkowo zostaje
obci¹¿one tymi nadmiarowymi danymi. Co wiêcej, po stronie odbiorcy nale¿y
przeprowadziæ rozbiór gramatyczny otrzymanego komunikatu. Zwiêksza to
zapotrzebowanie na moc obliczeniow¹. Mo¿e to mieæ kluczowe znaczenie w
przypadku urz¹dzeñ mobilnych, które czêsto dysponuj¹ bardzo ograniczonymi
zasobami mocy obliczeniowej oraz przepustowoœci. Szczególnym przypadkiem s¹
u¿ytkownicy, którzy posiadaj¹ niezrycza³towany dostêp do sieci i p³ac¹ ró¿ne
stawki, w zale¿noœci od iloœci przes³anych danych. W tym wypadku narzut
pojemnoœciowy Web Services mo¿na w sposób bezpoœredni przeliczyæ na koszty,
jakie generuje on dla ca³ej organizacji.
\newline
Z myœl¹ o bezpiecznej komunikacji przy u¿yciu technologii Web Services,
wprowadzono protokó³ komunikacyjny WS-Security (Web Service Security)
pozwalaj¹cy na zaaplikowanie podstawowych standardów bezpieczeñstwa. Protokó³
ten zawiera specyfikacjê, opisuj¹c¹ metody wymuszania integralnoœci oraz
poufnoœci przesy³anych danych. Pozwala na do³¹czanie do wiadomoœci SOAP
podpisów oraz nag³ówków zwi¹zanych z szyfrowaniem danych. Wspiera tak¿e
formaty certyfikacyjne, takie jak X.509. Protokó³ dzia³a w warstwie
aplikacyjnej i zosta³ tak zaprojektowany, by zapewniæ bezpieczeñstwo od koñca do koñca (end-to-end
security). Niestety, w obecnej chwili protokó³ ten nie zosta³ zaimplementowany
na urz¹dzeniach mobilnych i na pewno w najbli¿szym czasie nie stanie siê na
nich standardem. Ograniczeniem s¹ tu typowe dla tych urz¹dzeñ problemy z
wydajnoœci¹. Alternatywnym rozwi¹zaniem problemu bezpieczeñstwa jest pos³u¿enie
siê zabezpieczeniami na poziomie warstwy transportowej (TLS), takimi jak https.
Pozwala to na zapewnienie bezpieczeñstwa punkt-punkt.
\newline
Technologia Web Services jest godna rozwa¿enia przy wyborze sposobu komunikacji
w integracji mobilnej. Istniej¹ bardzo dobre implementacje, takie jak kSoap,
które dzia³aj¹ praktycznie na ka¿dej platformie wspieraj¹cej wirtualn¹ maszynê
Java. Pozosta³e platformy, takie jak Blackberry czy WMD (Windows Mobile Device),
równie¿ posiadaj¹ stosowne biblioteki pozwalaj¹ce w bardzo prosty sposób
pod³¹czyæ siê do istniej¹cej infrastruktury. Znane s¹ komercyjne rozwi¹zania
integracyjne, takie jak Mobile Data Service na platformie Blackberry, które
potrafi¹ automatycznie generowaæ kod, wywo³uj¹cy procedury na podstawie podanego
im wczeœniej schematu WSDL. Jeœli kluczowym nie jest optymalne wykorzystanie
³¹cza, czy te¿ gwarancja dostarczenia, to jest to technologia, której u¿ycie
jest zalecane przy integracji mobilnej, czy te¿ jakiejkolwiek innej integracji w
œrodowisku Enterprise.
\index{wiadomoœci}
\paragraph{Wiadomoœci w œrodowisku mobilnym} 
Integracja za pomoc¹ Web serwisów
jest doœæ prosta do zaimplementowania, stawia jednak przed programist¹ szereg
problemów,
które musi on samodzielnie rozwi¹zaæ. Jest to przede wszystkim brak gwarancji
dostarczenia komunikatu. Dodatkowo, samodzielnie nale¿y obs³u¿yæ b³êdy
transmisji, mo¿liwe przerwy i koniecznoœæ ponownego nawi¹zania po³¹czenia. Nie
implikuje to potrzeby uruchamiania brokera wiadomoœci, który jest dodatkowym
elementem zwiêkszaj¹cym skomplikowanie systemu. Jednak w sytuacji, gdy w
przedsiêbiorstwie dzia³a ju¿ broker obs³uguj¹cy kilka aplikacji, do³¹czenie
komponentu mobilnego mo¿e byæ dobrym rozwi¹zaniem. Zastosowanie wiadomoœci do 
integracji urz¹dzeñ mobilnych niesie ze sob¹ wszelkie konsekwencje tej metody 
integracji, znane z integracji klasycznych systemów informatycznych:

\begin{itemize}
  \item Oddzielenie nadawcy wiadomoœci od jej odbiorcy. Pozwala to na wysy³anie
  wiadomoœci nawet wtedy, gdy odbiorca nie jest w stanie jej aktualnie odebraæ 
  (na przyk³ad ze wzglêdu na brak po³¹czenia).
  \item Gwarancja dostarczenia. Z jednej strony, umieszczenie wiadomoœci w
  kanale komunikacyjnym gwarantuje, ¿e odbiorca odbierze j¹ wtedy, gdy bêdzie pobiera³ przeznaczone
  dla niego wiadomoœci. Z drugiej strony, w przypadku niepowodzenia jest o
  tym fakcie od razu informowany.
  \item Skalowalnoœæ. Wiadomoœci pozwalaj¹ na lepsze wykorzystanie
  zasobów serwerów. Aplikacje bêd¹ce odbiorcami wiadomoœci mog¹ je odbieraæ w
  tempie, w którym s¹ w stanie je przetwarzaæ. Wyklucza to wiêc mo¿liwoœæ ich
  przeci¹¿enia (tutaj oczywistym wymaganiem jest odpowiednio du¿a pojemnoœæ
  kolejki wiadomoœci).
  \item Nadawanie priorytetów. Dziêki wiadomoœciom mo¿emy przetwarzaæ ¿¹dania
  zgodnie z ich priorytetem, szczególnie w momentach wysokiego obci¹¿enia.
  Pozwala to na obs³u¿enie najpilniejszych wiadomoœci przed innymi (co nie jest
  mo¿liwe bez dodatkowych ingerencji w przypadku Web serwisów).
  \item Mo¿liwoœæ stosowania wzorców integracyjnych. Droga wiadomoœci pomiêdzy
  nadawc¹ i odbiorc¹ mo¿e byæ zmieniana w deklaratywny sposób (pomagaj¹ tu
  specjalne pakiety integracyjne, np. Apache Camel), co pozwala na dodatkowe
  przetwarzanie, konwertowanie, zmienianie kolejnoœci i inne modyfikacje
  przesy³anych wiadomoœci. Pod³¹czenie do kana³u publish-subscribe pozwala na
  ³atwe wysy³anie wiadomoœci do wielu odbiorców.
\end{itemize}
Nie jest to technologia pozbawiona wad. To, co musimy wzi¹æ pod
uwagê, to istnienie wspomnianego ju¿ brokera wiadomoœci. Dodatkowo,
wszystkie wspomniane wczeœniej mo¿liwoœci maj¹ swój koszt, jakim jest wiêkszy rozmiar
aplikacji mobilnej, wynikaj¹cy z koniecznoœci skorzystania z dodatkowych
komponentów. Nie jest to du¿y narzut w przypadku klasycznych aplikacji.
Zwiêksza on jednak rozmiary aplikacji mobilnej w stopniu, który mo¿e nie
pozwoliæ na jej uruchomienie na prostszych urz¹dzeniach.\\
\indent
\index{JMS}
W przeciwieñstwie do Web serwisów, nie wykszta³ci³ siê jeden uniwersalny
standard przesy³ania wiadomoœci. W ramach platformy J2ME naturalnym
rozwi¹zaniem jest JMS, który pochodzi z Javy Enterprise. Jednak inne
platformy, jak Windows Mobile, maj¹ swoje w³asne rozwi¹zania. Warto zwróciæ uwagê na
fakt, ¿e stosowanie wiadomoœci umo¿liwia zmianê najni¿szej warstwy
komunikacyjnej pomiêdzy urz¹dzeniami. O ile w przypadku Web serwisów oczywistym
wyborem jest po³¹czenie z internetem, o tyle wiadomoœci mog¹ byæ przesy³ane
zarówno w ten sposób, jak i za pomoc¹ SMS. Pozwala to na
funkcjonowanie aplikacji bez utrzymywania sta³ego po³¹czenia z internetem,
które w przypadku ograniczonej ³¹cznoœci jest mocno utrudnione. 


\indent
Na pytanie, która metoda: wiadomoœci czy Web serwisy, jest lepsza, nie ma
jednoznacznej odpowiedzi. Wszystko zale¿y od oczekiwañ u¿ytkownika, od
integrowanego systemu, jego natury oraz aktualnie istniej¹cych komponentów. Wydaje
siê, ¿e przed podjêciem decyzji warto zadaæ sobie nastêpuj¹ce pytania: 
\begin{itemize}
  \item Czy potrzebujemy gwarancji dostarczenia komunikatu, czy te¿ jest to
  system, w którym nie jest to kluczowe? Web serwisy nie zapewniaj¹ tej
  funkcjonalnoœci i w razie potrzeby musimy j¹ sami zaimplementowaæ.
  \item Czy integrujemy system mobilny z istniej¹cymi ju¿ systemami, które
  porozumiewaj¹ siê ze sob¹ za pomoc¹ brokera wiadomoœci? W takim wypadku,
  wykorzystanie wiadomoœci jest naturalnym rozwi¹zaniem, pozwalaj¹cym na
  dointegrowanie urz¹dzeñ mobilnych do sieci korporacyjnej.
  \item Czy bierzemy pod uwagê znaczne wydatki wynikaj¹ce z wykorzystania
  kosztownych, komercyjnych brokerów wiadomoœci? Wykorzystanie Web serwisów
  pozwala na znaczne obni¿enie kosztów wynikaj¹cych z obecnoœci wielu
  bezp³atnych platform opartych na otwartych standardach.
  \item Czy szybki czas dostarczenia jest kluczowy dla dzia³ania naszego
  systemu? Wiadomoœci wprowadzaj¹ pewien narzut czasowy, który jednak nie musi
  byæ istotny z naszego punktu widzenia.
\end{itemize}
Po przeanalizowaniu obu metod komunikacji w czêœci implementacyjnej naszej
pracy, zdecydowaliœmy siê na wykorzystanie Web serwisów z kilku powodów:
\begin{itemize}
  \item Wykorzystanie komercyjnego oprogramowania nie by³o mo¿liwe, a dodatkowo
  wymaga³oby uruchomienia skomplikowanej czêœci po stronie serwerowej. Naszym
  celem nie by³o konfigurowanie jednej skomplikowanej platformy, ale raczej 
 poznanie problemów, z którymi nale¿y siê liczyæ, integruj¹c aplikacjê
 mobiln¹.
  \item Wykorzystanie powszechnie dostêpnego pakietu kJORAM (bezp³atnej
  implementacji JMS, dostêpnej tak¿e dla urz¹dzeñ mobilnych) oznacza³o tak
  naprawdê wykorzystanie Web serwisów, które zosta³y odpowiednio obudowane
  przez twórców szablonu.
  \item Tworzony przez nas szablon komunikacyjny musia³ dzia³aæ z jak
  najmniejszym opóŸnieniem, tak aby u¿ytkownik nie odczuwa³ dyskomfortu
  zwi¹zanego z oczekiwaniem na kolejne ekrany. Zastosowanie wiadomoœci
  wprowadza dodatkowe opóŸnienie, które nie sprzyja responsywnoœci systemu.
\end{itemize}

