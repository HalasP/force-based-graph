\chapter{Przyk³adowy szablon komunikacyjny}

Do zademonstrowania mo¿liwoœci komunikacyjnych pomiêdzy systemem stacjonarnym i
mobilnym stworzyliœmy szablon u³atwiaj¹cy tworzenie aplikacji posiadaj¹cych
mobilny interfejs, z poziomu którego mo¿na sterowaæ aplikacj¹ serwerow¹.
Rozwi¹zanie, które przyjêliœmy jest na tyle ogólne, ¿e umo¿liwia rozwi¹zanie
kilku podobnych problemów, które przedstawimy dalej.

\section{Istniej¹ce sposoby dostêpu do informacji z urz¹dzenia mobilnego}
Przyjrzyjmy siê jednak najpierw mo¿liwym sposobom zdalnego dostêpu do danych z
poziomu urz¹dzenia mobilnego. Przedstawione sposoby byæ mo¿e nie wyczerpuj¹
wszystkich mo¿liwoœci podzia³u, jednak daj¹ obraz tego w jaki sposób tworzone
s¹ dzisiaj aplikacje mobilne.

\subsection{Mobilne przegl¹darki}
Urz¹dzenia mobilne, w tym telefony komórkowe, maj¹ wbudowane przegl¹darki
internetowe, za pomoc¹ których coraz czêœciej mo¿na przegl¹daæ wszystkie
dostêpne w Internecie strony (w przeciwieñstwie do sytuacji sprzed kilku lat,
gdy jedynie czêœæ z nich, posiadaj¹ca wersjê WAP, by³a dostêpna). Trzeba
przyznaæ, ¿e w tym czasie dokona³ siê du¿y postêp w rozwoju mobilnych
przegl¹darek. Ci¹gle jednak nie zapewniaj¹ one wygody porównywalnej z
przegl¹daniem stron na tradycyjnym komputerze. Z drugiej strony, korzystanie z
aplikacji zbudowanych w oparciu o model trójwarstwowy (z u¿yciem tzw. cienkiego
klienta - czyli przegl¹darki WWW) niesie za sob¹ szereg korzyœci, jak brak
potrzeby instalowania aplikacji,³atwoœæ wdro¿enia czy wreszcie ca³kowita
przenoœnoœæ. 

\subsection{Aplikacje mobilne}
Innym podejœciem, przypominaj¹cym aplikacje zbudowane w oparciu o model
dwuwarstwowy, jest stworzenie aplikacji mobilnej, która samodzielnie ³¹czy siê
z Internetem i umo¿liwia wyœwietlanie i modyfikacjê danych w sposób
przewidziany przez jej twórców. Ogranicza to oczywiœcie funkcjonalnoœæ takiej
aplikacji do zakresu przewidzianego w danej wersji, a wszelkie zmiany wymagaj¹
jej aktualizacji. W zamian za to otrzymujemy wiêksz¹ szybkoœæ dzia³ania,
mo¿liwoœæ walidacji danych po stronie klienta oraz elastycznoœæ w tworzeniu
interfejsu (który w tym przypadku nie jest ograniczony do kontrolek
zapewnianych przez przegl¹darkê WWW).

Wad¹ z której niewiele osób zdaje sobie
sprawê jest mniejsza przenoœnoœæ aplikacji, choæby by³y one napisane w jêzyku
projektowanym z myœl¹ o niezale¿noœci od platformy, takim jak Java. 
[Dlaczego,mo¿e by tu coœ napisaæ?]


\subsection{Generatory aplikacji}
[Wojtek - tu Ty coœ napisz:)]

\section{Idea szablonu}
Ide¹ stoj¹c¹ za stworzeniem szablonu by³o po³¹czenie zalet zapewnianych przez
aplikacjê zbudowan¹ w oparciu o model trójwarstwowy z tymi typowymi
dla samodzielnej aplikacji. Stworzone rozwi¹zanie stanowi raczej pomys³, który
mo¿na rozwijaæ i wykorzystywaæ do budowy bardziej skomplikowanych systemów.
Dlatego te¿ mo¿liwoœci takiego podejœcia nie s¹ ograniczone przez stworzony
szablon.
\newline
Szablon sk³ada siê z dwóch czêœci - mobilnej i serwerowej.
U¿ytkownik mo¿e okreœliæ wygl¹d ekranu przesy³anego do urz¹dzenia mobilnego,
który po stronie mobilnej interpretowany jest do postaci elementów interfejsu
ciê¿kiego klienta, np pól tekstowych, wyboru czy rozwijanych list. 
Rozszerza to mo¿liwoœci aplikacji w stosunku do zwyk³ej strony internetowej o
elementy niedostêpne w przypadku statycznej strony WWW jak rysunki
wektorowe,obs³uga przycisków urz¹dzenia czy mo¿liwoœæ wyœwietlania strony przez
jakiœ czas.
\newline
W typowym przypadku scenariusz u¿ycia aplikacji bêdzie wygl¹da³
nastêpuj¹co:
\begin{itemize}
  \item Tworzymy nowy 'ekran' na serwerze. Oznacza to okreœlenie wygl¹du i
  zachowania aplikacji w formacie XML. Okreœlamy dostêpne dla
  danego ekranu akcje. 
  \item Aplikacja mobilna ³¹czy siê z serwerem i pobiera przygotowany dla niej
  ekran. U¿ytkownik wykonuje jedn¹ z dostêpnych na nim akcji, a informacja o
  tym jest przesy³ana do serwera. Dodatkowo aplikacja mo¿e wykonaæ dowolne
  zdefiniowane akcje. W ten sposób pojawia siê mo¿liwoœæ kontrolowania ekranu
  po stronie klienta w dowolny sposób.
  \item Aplikacja mobilna pobiera kolejny ekran przygotowany przez serwer i
  dalej postêpuje wed³ug powy¿szego schematu.
\end{itemize}


\subsection{Mo¿liwoœci}
Aplikacja oparta o tak zaprojektowany model posiada³aby cechy typowe dla modelu
dwuwarstwowego - w tym szybki czas reakcji, niezale¿noœæ wygl¹du aplikacji od
stosowanego klienta oraz mo¿liwoœæ przeprowadzenia pewnych dodatkowych operacji
(jak walidacja) po stronie klienta. W idealnym przypadku móg³by byæ
dynamicznie przesy³any kod wykonywany po stronie klienta (odpowiednik JavaScript
w przypadku przegl¹darki internetowej). Pozbawiona by³aby te¿ typowych wad obu rozwi¹zañ -
brak koniecznoœci aktualizowania aplikacji przy drobnych poprawkach (poza
b³êdami w zainstalowanym oprogramowaniu). Nie by³aby równie¿ ograniczona do
mechanizmów oferowanych przez statyczne strony WWW - mo¿na by by³o
wyœwietlaæ dowolne ekrany, a na nich wykonywaæ dowolne akcje.
Dodatkowo, poniewa¿ stan aplikacji przechowywany by³by na serwerze, mo¿na w
dowolnym momencie zmieniæ urz¹dzenie mobilne, wy³¹czyæ aplikacjê, a potem
powróciæ do zapamiêtanego wczeœniej miejsca.
 
\subsection{Dlaczego to jest nowatorskie - jak by to napisaæ?}

\subsection{Mo¿liwe zastosowania}


\subsubsection{Ankietowanie}
\subsubsection{Zdalne podejmowanie decyzji}

\subsection{Architektura}
Tak jak zosta³o to ju¿ wspomniane szablon sk³ada siê z dwóch
g³ównych czêœci - serwerowej oraz mobilnej. Przed przejœciem do szczegó³ów
implementacyjnych zaprezentujemy koncepcjê ca³ego systemu.

\setlength\fboxsep{5pt}  
\setlength\fboxrule{0.0pt}
\begin{center}
\fbox{\scalebox{0.7}{\includegraphics{img/diag1.png} }}
\end{center}
Jak widaæ, urz¹dzenia mobilne bêd¹ siê ³¹czy³y przez Internet do uruchomionego
serwera aplikacyjnego. Ka¿de z nich wysy³a ¿¹danie pobrania ekranu, który jest
dynamicznie przygotowywany w zale¿noœci od stanu aplikacji dla danego
u¿ytkownika. Warto tu zwróciæ uwagê, ¿e szablon jest pomyœlany w³aœciwie
wy³¹cznie dla urz¹dzeñ mobilnych - stosowane rozwi¹zania, s¹ albo niedostêpne,
albo ma³o przydatne w przypadku komputerów stacjonarnych, o czym napiszemy
w dalszej czêœci pracy. 
\newline
Podczas projektowania szablonu pojawi³y siê w¹tpliwoœci co do sposobu
komunikacji pomiêdzy elementami systemu. Pocz¹tkowa i bardzo przekonuj¹ca
koncepcja zak³ada³a wykorzystanie JMS - Java Messaging System, specyfikacji
umo¿liwaj¹cej przesy³anie wiadomoœci w Javie. Przemawia³ za tym szereg
argumentów:
\begin{itemize}
  \item Niezawodnoœæ - gwarancja dostarczenia wiadomoœci w warunkach ³¹cznoœci
  bezprzewodowej, która jest szczególnie nara¿ona na przerwy w transmisji.
  \item Niezale¿noœæ systemów - u¿ycie wiadomoœci znacznie u³atwi³oby
  ewentualne zmiany po stronie serwera aplikacyjnego, ze wzglêdu na dodatkowy
  element poœrednicz¹cy jakim jest serwer wiadomoœci.
  \item £atwoœæ implementacji - przesy³ane wiadomoœci mog¹ zawieraæ
  zserializowane obiekty, co zdejmuje z programisty obowi¹zek samodzielnej
  serializacji i deserializacji danych.
\end{itemize}
Jak siê jednak okaza³o,istotne ograniczenia techniczne po stronie urz¹dzeñ
mobilnych uniemo¿liwi³y skorzystanie z JMS. Jest to technologia wymagaj¹ca
znacznych zasobów, niedostêpnych w specyfikacji Java Micro Edition - platformy
na której stworzyliœmy nasz szablon. Nie daje ona mo¿liwoœci bezpoœredniego
pod³¹czenia do kana³u komunikacyjnego, co wymusza korzystanie z zewnêtrznych
bibliotek. Jednak nawet wtedy, okazuje siê, ¿e takie biblioteki korzystaj¹ z
Web Serwisów jako technologii poœrednicz¹cej w komunikacji. Podobnie,
automatyczna serializacja i deserializacja w takiej sytuacji nie jest jeszcze
wspierana. 
\newline
Z tych powodów zdecydowaliœmy siê na wykorzystanie Web serwisów jako warstwy
komunikacyjnej i samodzielne rozwi¹zanie problemów, które siê z tym wi¹¿¹.

\subsubsection{Aplikacja serwerowa}

Przedstawimy teraz architekturê czêœci serwerowej, komponenty z których siê
sk³ada i technologie, które wykorzystuj¹.
\setlength\fboxsep{5pt}  
\setlength\fboxrule{0.0pt}

\begin{center}
\fbox{\scalebox{0.7}{\includegraphics{img/diag2.png} }}
\end{center}

Aplikacja serwerowa zbudowana zosta³a w oparciu o model trójwarstwowy, z
podwójnym dostêpem (widokiem) do danych. Aby zrozumieæ projekt ca³ego systemu
wprowadŸmy pewne pojêcia w naszym systemie, z których wynikaj¹ dalsze
rozwi¹zania: 
\begin{itemize}
  \item \emph{Ankieta} - treœæ, dla której istniej¹ dostêpne zdefiniowane
  odpowiedzi.
 \item \emph{OdpowiedŸ} - jedna z mo¿liwoœci wyboru dostêpnych dla danej ankiety
  \item \emph{U¿ytkownik} - konto z którym zwi¹zane s¹ uprawnienia i udzielone
  w ankietach odpowiedzi. Jeden u¿ytkownik mo¿e udzieliæ wielu odpowiedzi w
  trakcie dzia³ania ca³ego systemu.
\end{itemize}
W oparciu o te za³o¿enia stworzony zosta³ prosty schemat bazy danych:
\begin{center}
\fbox{\scalebox{0.7}{\includegraphics{img/pool_schema_o.png} }}
\end{center}

Choæ wydaje siê, ¿e ogranicza to dzia³anie systemu do mo¿liwoœci wyboru
odpowiedzi z dostêpnej listy, to jednak schemat bez problemu mo¿na rozbudowaæ o
dodatkowe pola, które pozwol¹ na podawanie wolnych (nieograniczonych dostêpn¹
list¹ wyboru) odpowiedzi.
\newline
Na postawie schematu koncepcyjnego stworzony zosta³ schemat fizyczny bazy
danych:
\newline
\begin{center}
\fbox{\scalebox{0.7}{\includegraphics{img/pool_schema.png} }}
\end{center}


\subsubsection{Aplikacja mobilna}

\subsection{Istniej¹ce problemy}

\subsubsection{Bezpieczeñstwo}

\subsubsection{Gwarancja dostarczenia}

\subsubsection{Transakcyjnoœæ}